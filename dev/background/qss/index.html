<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantized State System Methods · Quantized System Solver</title><meta name="title" content="Quantized State System Methods · Quantized System Solver"/><meta property="og:title" content="Quantized State System Methods · Quantized System Solver"/><meta property="twitter:title" content="Quantized State System Methods · Quantized System Solver"/><meta name="description" content="Documentation for Quantized System Solver."/><meta property="og:description" content="Documentation for Quantized System Solver."/><meta property="twitter:description" content="Documentation for Quantized System Solver."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Quantized System Solver logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Quantized System Solver</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/userTutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/userAPI/">User API</a></li></ul></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../introductoryResources/">Introduction to Quantized System Methods</a></li><li class="is-active"><a class="tocitem" href>Quantized State System Methods</a><ul class="internal"><li><a class="tocitem" href="#QSS1"><span>QSS1</span></a></li><li><a class="tocitem" href="#QSS2"><span>QSS2</span></a></li></ul></li><li><a class="tocitem" href="../liqss/">Linearly Implicit Quantized State System Methods</a></li><li><a class="tocitem" href="../mliqss/">Modified Linearly Implicit Quantized State System Methods</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/linearTimeInvariantSystem/">Linear Time Invariant</a></li><li><a class="tocitem" href="../../examples/linearTimeInvariantSystemEvents/">Linear Time Invariant with events</a></li><li><a class="tocitem" href="../../examples/vanderpol/">Van der Pol</a></li><li><a class="tocitem" href="../../examples/tysonModel/">The Tyson Model</a></li><li><a class="tocitem" href="../../examples/adr/">ADR problem</a></li><li><a class="tocitem" href="../../examples/dosing/">Conditional Dosing in Pharmacometrics</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/devIntro/">Developer Guide</a></li><li><a class="tocitem" href="../../developer/problem/">Problem</a></li><li><a class="tocitem" href="../../developer/algorithm/">QSS Algorithms</a></li><li><a class="tocitem" href="../../developer/solve/">Solve</a></li><li><a class="tocitem" href="../../developer/integrator/">Integrators</a></li><li><a class="tocitem" href="../../developer/quantizer/">Quantizer</a></li><li><a class="tocitem" href="../../developer/solution/">Solution</a></li><li><a class="tocitem" href="../../developer/taylor/">Taylor Variables</a></li><li><a class="tocitem" href="../../developer/utils/">Utils references</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Background</a></li><li class="is-active"><a href>Quantized State System Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantized State System Methods</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mongibellili/QuantizedSystemSolver.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/main/docs/src/background/qss.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quantized-State-System-Methods"><a class="docs-heading-anchor" href="#Quantized-State-System-Methods">Quantized State System Methods</a><a id="Quantized-State-System-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Quantized-State-System-Methods" title="Permalink"></a></h1><h2 id="QSS1"><a class="docs-heading-anchor" href="#QSS1">QSS1</a><a id="QSS1-1"></a><a class="docs-heading-anchor-permalink" href="#QSS1" title="Permalink"></a></h2><p>The QSS1 method is the simplest of the QSS methods. It is based on the assumption that the state variables are piecewise constant between the thresholds. The state variables are updated only when a threshold is crossed. The time of the next threshold crossing is computed explicitly. The QSS1 method is a first-order method, and the state variables are updated using a taylor expansion, similar to the Euler method, given by the following equations:</p><p class="math-container">\[    \begin{align*}
      &amp; x_{i}=x_{i}+\dot x_i.e_i  
    \end{align*}\]</p><p>where <span>$x_{i}$</span> is the <span>$i^{th}$</span> state variable, <span>$\dot x_i$</span> is the derivative of this state variable, and <span>$e$</span> is the elapsed time since its last update. The next time of change is computed as <span>$t_i^n=t_{current}+\frac{\Delta_i}{|\dot x_i|}$</span> where <span>$\Delta_i$</span> is the quantum of the variable <span>$x_i$</span>. The QSS1 method is defined in the foloowing Algorithm.</p><p><strong>QSS1 algorithm</strong></p><ol><li>If a variable <span>$i$</span> needs to change<ul><li>Compute the elapsed time <span>$e_i$</span> since the last update of variable <span>$i$</span></li><li>Update the variable <span>$x_{i}=x_{i}+\dot x_i.e_i$</span></li><li>Update the quantum <span>$\Delta_i$</span></li><li>Update the Quantized variable <span>$q_i$</span> = <span>$x_i$</span></li><li>Compute the next time of change <span>$t_i^n$</span></li><li>For any variable <span>$j$</span> depends on <span>$i$</span><ul><li>Update the variable <span>$x_{j}=x_{j}+\dot x_j.e_j$</span></li><li>Update the derivative <span>$\dot x_j=f_j(Q,t)$</span> </li><li>Compute the next time when <span>$q_j=x_j \; or |q_j-x_j|=2\Delta_j$</span> </li></ul></li><li>For any zero crossing function <span>$zc$</span> depends on <span>$i$</span><ul><li>Update <span>$zc$</span></li><li>Compute the next event time of <span>$zc$</span> </li></ul></li></ul></li><li>If an event needs to occur<ul><li>recheck validity of the event</li><li>execute the event and update the related quantized variables</li><li>For any variable <span>$j$</span> depends on the event<ul><li>Update the variable <span>$x_{j}=x_{j}+\dot x_j.e_j$</span></li><li>Update the derivative <span>$\dot x_j=f_j(Q,t)$</span> </li><li>Compute the next time when <span>$q_j=x_j \; or |q_j-x_j|=2\Delta_j$</span> </li></ul></li><li>For any zero crossing function <span>$zc$</span> depends on the event<ul><li>Update <span>$zc$</span></li><li>Compute the next event time of <span>$zc$</span> </li></ul></li></ul></li></ol><h2 id="QSS2"><a class="docs-heading-anchor" href="#QSS2">QSS2</a><a id="QSS2-1"></a><a class="docs-heading-anchor-permalink" href="#QSS2" title="Permalink"></a></h2><p>The QSS2 method is a second-order method. The state variables are updated using a Taylor expansion given by the following equations:</p><p class="math-container">\[  \begin{align*}
    &amp; x_{i}=x_{i}+\dot x_i.e_i+\frac{1}{2}\ddot x_i.e_i^2  \\
    &amp; \dot x_{i}=\dot x_{i}+\ddot x_i.e_i 
  \end{align*}\]</p><p>where <span>$\ddot x_i$</span> is the second derivative of this state variable. The next time of change is computed as <span>$t_i^n=t_{current}+sqrt(\frac{\Delta_i}{|\ddot x_i|})$</span>. The QSS2 method is defined in the following Algorithm.</p><p><strong>QSS2 algorithm</strong></p><ol><li>If a variable <span>$i$</span> needs to change<ul><li>Compute the elapsed time <span>$e_i$</span> since the last update of variable <span>$i$</span></li><li>Update the variable <span>$x_{i}=x_{i}+\dot x_i.e_i+\frac{1}{2}\ddot x_i.e_i^2$</span></li><li>Update the quantum <span>$\Delta_i$</span></li><li>Update the variable <span>$\dot x_{i}=\dot x_{i}+\ddot x_i.e$</span></li><li>Update the Quantized variable <span>$q_i$</span> = <span>$x_i$</span></li><li>Update the Quantized derivative <span>$\dot q_i$</span> = <span>$\dot x_i$</span></li><li>Compute the next time of change <span>$t_i^n$</span></li><li>For any variable <span>$j$</span> depends on <span>$i$</span><ul><li>Update the variable <span>$x_{j}=x_{j}+\dot x_j.e_j+\frac{1}{2}\ddot x_j.e_j^2$</span></li><li>For any variable <span>$k$</span> that <span>$f_j$</span> depends upon<ul><li>Update the Quantized variable <span>$q_{k}=q_{k}+\dot q_k.e_k$</span></li></ul></li><li>Update the derivative <span>$\dot x_j=f_j(Q,t)$</span> </li><li>Update the second derivative <span>$\ddot x_j=\dot f_j(Q,t)$</span> </li><li>Compute the next time when <span>$q_j=x_j \; or |q_j-x_j|=2\Delta_j$</span> </li></ul></li><li>For any zero crossing function <span>$zc$</span> depends on <span>$i$</span><ul><li>For any variable <span>$k$</span> that <span>$zc$</span> depends upon<ul><li>Update the Quantized variable <span>$q_{k}=q_{k}+\dot q_k.e_k$</span></li></ul></li><li>Update <span>$zc$</span></li><li>Compute the next event time of <span>$zc$</span> </li></ul></li></ul></li><li>If an event needs to occur<ul><li>recheck validity of the event</li><li>execute the event and update the related quantized variables</li><li>For any variable <span>$j$</span> depends on the event<ul><li>Update the variable <span>$x_{j}=x_{j}+\dot x_j.e_j+\frac{1}{2}\ddot x_j.e_j^2$</span></li><li>For any variable <span>$k$</span> that <span>$f_j$</span> depends upon<ul><li>Update the Quantized variable <span>$q_{k}=q_{k}+\dot q_k.e_k$</span></li></ul></li><li>Update the derivative <span>$\dot x_j=f_j(Q,t)$</span> </li><li>Update the second derivative <span>$\ddot x_j=\dot f_j(Q,t)$</span> </li><li>Compute the next time when <span>$q_j=x_j \; or |q_j-x_j|=2\Delta_j$</span> </li></ul></li><li>For any zero crossing function <span>$zc$</span> depends on the event<ul><li>For any variable <span>$k$</span> that <span>$zc$</span> depends upon<ul><li>Update the Quantized variable <span>$q_{k}=q_{k}+\dot q_k.e_k$</span></li></ul></li><li>Update <span>$zc$</span></li><li>Compute the next event time of <span>$zc$</span> </li></ul></li></ul></li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../introductoryResources/">« Introduction to Quantized System Methods</a><a class="docs-footer-nextpage" href="../liqss/">Linearly Implicit Quantized State System Methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 28 February 2025 23:45">Friday 28 February 2025</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
