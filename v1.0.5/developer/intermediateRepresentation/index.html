<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>IR · Quantized System Solver</title><meta name="title" content="IR · Quantized System Solver"/><meta property="og:title" content="IR · Quantized System Solver"/><meta property="twitter:title" content="IR · Quantized System Solver"/><meta name="description" content="Documentation for Quantized System Solver."/><meta property="og:description" content="Documentation for Quantized System Solver."/><meta property="twitter:description" content="Documentation for Quantized System Solver."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Quantized System Solver logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Quantized System Solver</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/userTutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/userAPI/">User API</a></li></ul></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../background/introductoryResources/">Introduction to Quantized System Methods</a></li><li><a class="tocitem" href="../../background/qss/">Quantized State System Methods</a></li><li><a class="tocitem" href="../../background/liqss/">Linearly Implicit Quantized State System Methods</a></li><li><a class="tocitem" href="../../background/mliqss/">Modified Linearly Implicit Quantized State System Methods</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/linearTimeInvariantSystem/">Linear Time Invariant</a></li><li><a class="tocitem" href="../../examples/linearTimeInvariantSystemEvents/">Linear Time Invariant with events</a></li><li><a class="tocitem" href="../../examples/vanderpol/">Van der Pol</a></li><li><a class="tocitem" href="../../examples/tysonModel/">The Tyson Model</a></li><li><a class="tocitem" href="../../examples/adr/">ADR problem</a></li><li><a class="tocitem" href="../../examples/dosing/">Conditional Dosing in Pharmacometrics</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../devIntro/">Developer Guide</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox" checked/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">IR model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../normalize_ir/">Normalize_IR</a></li><li class="is-active"><a class="tocitem" href>IR</a><ul class="internal"><li><a class="tocitem" href="#Goal:-separate-the-problem-parsing-from-the-problem-construction."><span>Goal: separate the problem parsing from the problem construction.</span></a></li><li><a class="tocitem" href="#Example:"><span>Example:</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">problem construction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../problem/">Problem</a></li><li><a class="tocitem" href="../problemFunction/">Problem Function</a></li><li><a class="tocitem" href="../problem_references/">Problem Internals</a></li></ul></li><li><a class="tocitem" href="../algorithm/">QSS Algorithms</a></li><li><a class="tocitem" href="../solve/">Solve</a></li><li><a class="tocitem" href="../integrator/">Integrators</a></li><li><a class="tocitem" href="../quantizer/">Quantizer</a></li><li><a class="tocitem" href="../solution/">Solution</a></li><li><a class="tocitem" href="../taylor/">Taylor Variables</a></li><li><a class="tocitem" href="../utils/">Utils references</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer resources</a></li><li><a class="is-disabled">IR model</a></li><li class="is-active"><a href>IR</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>IR</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mongibellili/QuantizedSystemSolver.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/main/docs/src/developer/intermediateRepresentation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="IR"><a class="docs-heading-anchor" href="#IR">IR</a><a id="IR-1"></a><a class="docs-heading-anchor-permalink" href="#IR" title="Permalink"></a></h1><h2 id="Goal:-separate-the-problem-parsing-from-the-problem-construction."><a class="docs-heading-anchor" href="#Goal:-separate-the-problem-parsing-from-the-problem-construction.">Goal: separate the problem parsing from the problem construction.</a><a id="Goal:-separate-the-problem-parsing-from-the-problem-construction.-1"></a><a class="docs-heading-anchor-permalink" href="#Goal:-separate-the-problem-parsing-from-the-problem-construction." title="Permalink"></a></h2><p>problem parsing is delegated to a new Module named <strong>SimpleModelIR</strong>:</p><pre><code class="language-Julia hljs">module SimpleModelIR
using MacroTools: postwalk 
include(&quot;utils.jl&quot;)
include(&quot;types.jl&quot;)
include(&quot;build_ir.jl&quot;)
include(&quot;normalize_ir.jl&quot;)
export
    AbstractODEStatement,
    AssignStatement,
    IfStatement,
    ForStatement,
    WhileStatement,
    ExprStatement,
    ODEFunctionIR,
    build_ir,
    normalize_ir,
    problem_to_normalized_ir,
end</code></pre><p>The <em>build</em>ir_ function loops through the user code expression and builds an ODEFunctionIR(statement). i.e the expression will be changed to a vector of statements. Each statement is an object of type ....&lt;: AbstractODEStatement The <em>normalize</em>ir_ function loops over the vectors and call personalized functions such as <em>changeVarNames</em>params_ or <em>normalize</em>if<em>statement!</em> to change composite if-statements to simple if-statements.</p><h2 id="Example:"><a class="docs-heading-anchor" href="#Example:">Example:</a><a id="Example:-1"></a><a class="docs-heading-anchor-permalink" href="#Example:" title="Permalink"></a></h2><pre><code class="language-Julia hljs">  function simpleModel(dy,y,p,t)# api requires four args
      U = 24.0; 
      rd,rs=p;
      il=y[1] 
      id=(il*rs-U)/(rd+rs)
      dy[1] =id
      dy[2]=il
      if t&gt;0 || y[2]&gt;0 &amp;&amp; y[1]&gt;y[2]
        y[1]=0.0
      else
        y[2]=0.0
      end       
   end</code></pre><p>build<em>ir</em> –&gt;</p><pre><code class="language-Julia hljs">ir = SimpleModelIR.ODEFunctionIR(SimpleModelIR.AbstractODEStatement[SimpleModelIR.AssignStatement(:U, 24.0), 
SimpleModelIR.AssignStatement(:((rd, rs)), :p), SimpleModelIR.AssignStatement(:il, :(y[1])), SimpleModelIR.AssignStatement(:id, :
((il * rs - U) / (rd + rs))), SimpleModelIR.AssignStatement(:(dy[1]), :id), SimpleModelIR.AssignStatement(:(dy[2]), :il), 
SimpleModelIR.IfStatement(:(t &gt; 0 || y[2] &gt; 0 &amp;&amp; y[1] &gt; y[2]), :(if t &gt; 0 || y[2] &gt; 0 &amp;&amp; y[1] &gt; y[2]
      y[1] = 0.0
  else
      y[2] = 0.0
  end))])</code></pre><p>normalize<em>ir</em> –&gt;</p><pre><code class="language-Julia hljs">ir = SimpleModelIR.ODEFunctionIR(SimpleModelIR.AbstractODEStatement[SimpleModelIR.AssignStatement(:U, 24.0), 
SimpleModelIR.AssignStatement(:((rd, rs)), :p), SimpleModelIR.AssignStatement(:il, :(q[1])), SimpleModelIR.AssignStatement(:id, :
((q[1] * p[2] - 24.0) / (p[1] + p[2]))), SimpleModelIR.AssignStatement(:(dy[1]), :((q[1] * p[2] - 24.0) / (p[1] + p[2]))), 
SimpleModelIR.AssignStatement(:(dy[2]), :(q[1])), SimpleModelIR.IfStatement(:(t - 0.0), :(if t - 0.0
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  else
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  end)), SimpleModelIR.IfStatement(:(q[2] - 0.0), :(if q[2] - 0.0
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  else
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  end)), SimpleModelIR.IfStatement(:(q[1] - q[2]), :(if q[1] - q[2]
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  else
      if t &gt; 0.0 || q[2] &gt; 0.0 &amp;&amp; q[1] &gt; q[2]
          q[1] = 0.0
      else
          q[2] = 0.0
      end
  end))])</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.problem_to_normalized_ir-Tuple{Expr, Symbol, Symbol}" href="#QuantizedSystemSolver.SimpleModelIR.problem_to_normalized_ir-Tuple{Expr, Symbol, Symbol}"><code>QuantizedSystemSolver.SimpleModelIR.problem_to_normalized_ir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">problem_to_normalized_ir(expr::Expr, stateVarName::Symbol, discrParamName::Symbol)</code></pre><p>Converts a symbolic problem expression into a normalized intermediate representation (IR).</p><p><strong>Arguments</strong></p><ul><li><code>expr::Expr</code>: The symbolic expression representing the problem to be normalized.</li><li><code>stateVarName::Symbol</code>: The symbol representing the state variable in the problem.</li><li><code>discrParamName::Symbol</code>: The symbol representing the discrete variable in the problem.</li></ul><p><strong>Returns</strong></p><ul><li><code>probInfo</code>: A structure containing the normalized IR and associated problem information.</li></ul><p><strong>Description</strong></p><p>This function processes the input symbolic expression, extracting relevant information and transforming it into a normalized IR suitable for further analysis or code generation.  It uses the provided state variable and discretization parameter names to correctly interpret the structure of the problem. this process is delegated to build<em>ir and normalize</em>ir functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/build_ir.jl#L82-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.build_ir-Tuple{Expr}" href="#QuantizedSystemSolver.SimpleModelIR.build_ir-Tuple{Expr}"><code>QuantizedSystemSolver.SimpleModelIR.build_ir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_ir(expr::Expr)</code></pre><p>Converts a symbolic expression into an ODEFunctionIR representation.</p><p><strong>Arguments</strong></p><ul><li><code>expr::Expr</code>: The symbolic expression to be converted into an ODEFunctionIR.</li></ul><p><strong>Returns</strong></p><ul><li><code>ODEFunctionIR</code>: An intermediate representation of the ODE function, encapsulating the parsed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/build_ir.jl#L64-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.AbstractODEStatement" href="#QuantizedSystemSolver.SimpleModelIR.AbstractODEStatement"><code>QuantizedSystemSolver.SimpleModelIR.AbstractODEStatement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractODEStatement</code></pre><p>An abstract type representing a single statement in the user code. This serves as a base type for various specific types of statements that can be part of an ODE function&#39;s intermediate representation (IR). It is used to encapsulate different kinds of operations, such as assignments, conditional statements, loops, and expressions, allowing for a structured representation of the ODE function&#39;s logic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/types.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.AssignStatement" href="#QuantizedSystemSolver.SimpleModelIR.AssignStatement"><code>QuantizedSystemSolver.SimpleModelIR.AssignStatement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AssignStatement</code></pre><p>Represents an assignment statement within an ODE statement in the intermediate representation (IR) of a simple model. This mutable struct is used to store information about lhs and rhs parts of an assignment.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/types.jl#L14-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.IfStatement" href="#QuantizedSystemSolver.SimpleModelIR.IfStatement"><code>QuantizedSystemSolver.SimpleModelIR.IfStatement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IfStatement</code></pre><p>Represents a conditional (if) statement within the intermediate representation (IR) of a simple model ODE system.</p><p><strong>Fields</strong></p><ul><li><code>condition</code>: The condition expression to evaluate. it represents the zero-crossing function for an event.</li><li><code>body</code>: The statements to execute if the condition is true. it contains an expression of the whole if-statment. It will be used as the actual execution of the event.</li></ul><p><strong>Usage</strong></p><p>Used to model control flow in the IR for ODE problem generation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/types.jl#L27-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.ForStatement" href="#QuantizedSystemSolver.SimpleModelIR.ForStatement"><code>QuantizedSystemSolver.SimpleModelIR.ForStatement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForStatement</code></pre><p>Represents a <code>for</code> loop statement within the intermediate representation (IR) of an ODE problem.</p><p><strong>Description</strong></p><p>This mutable struct is a subtype of <code>AbstractODEStatement</code> and is used to represent a <code>for</code> loop that is used to define differential equations.</p><p><strong>Example</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/types.jl#L44-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantizedSystemSolver.SimpleModelIR.ExprStatement" href="#QuantizedSystemSolver.SimpleModelIR.ExprStatement"><code>QuantizedSystemSolver.SimpleModelIR.ExprStatement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExprStatement</code></pre><p>A mutable struct representing an expression statement within the ODE problem intermediate representation (IR).</p><p><strong>Description</strong></p><p><code>ExprStatement</code> is used to encapsulate a single expression that was not handled by other specific statement types like <code>AssignStatement</code>, <code>IfStatement</code>, <code>ForStatement</code>, or <code>WhileStatement</code>. It allows for the inclusion of arbitrary expressions in the IR, which can be useful for representing complex operations or computations that do not fit neatly into the other categories.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mongibellili/QuantizedSystemSolver.jl/blob/41debd13396e9e7eb49f93aafade8bd5327cbb47/src/problem_generator/simpleModelIR/types.jl#L71-L80">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../normalize_ir/">« Normalize_IR</a><a class="docs-footer-nextpage" href="../problem/">Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Saturday 12 July 2025 19:00">Saturday 12 July 2025</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
